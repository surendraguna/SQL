1. QUERY :-

SELECT * FROM MOVIES
WHERE MLANGUAGE = 'TELUGU' AND MRATING IN (
								SELECT MIN(MRATING) FROM MOVIES 
								WHERE MRATING IN (	
											SELECT TOP 2 MRATING FROM MOVIES		
											ORDER BY MRATING DESC	
											)
							 )

OUTPUT :=

MID	MNAME				MLANGUAGE	MRATING
501	DASARA			TELUGU	9
512	ORANGE			TELUGU	9
523	JAI LAVA KUSHA		TELUGU	9
525	SHIVAJI			TELUGU	9


2. * QUERY :=

SELECT MRATING, AVG(MRATING) AS "AVG RATING" FROM MOVIES
GROUP BY MRATING
HAVING COUNT(*) >= 2

OUTPUT :-

MRATING	AVG RATING
5		5
6		6
7		7
8		8
9		9

3. QUERY :-

SELECT C.CNAME FROM CUSTOMER C 
WHERE CNAME LIKE '%__H'	AND C.CID IN (	
							SELECT R.CID FROM RESERVE R
							JOIN MOVIES M ON M.MID = R.MID 
							WHERE MLANGUAGE = 'ENGLISH'	
						  )

OUTPUT :-

CNAME
SUNATH

4. QUERY :-

SELECT * FROM CUSTOMER C
WHERE AGE BETWEEN 30 AND 50 AND C.CID IN (
								SELECT CID FROM RESERVE
						     )
OUTPUT :-

SERIAL NUMBER	CID	CNAME		AGE	CRATING
12			112	ARYA		30	9
16			116	RAJINIKANTH	35	7

5. QUERY :-

SELECT CNAME, C.CID FROM CUSTOMER C
JOIN RESERVE R ON C.CID = R.CID
JOIN MOVIES M ON M.MID = R.MID
WHERE MNAME IN ( 'DASARA','THOR(LOVE AND THUNDER)')
GROUP BY CNAME, C.CID

OUTPUT :-

CNAME		CID
SURYA		101
RAJINIKANTH	116

6. QUERY :-

SELECT AVG(AGE) AS AVG_AGE FROM CUSTOMER C
WHERE C.CID IN (
			SELECT R.CID FROM RESERVE R
			WHERE R.MID IN (
						SELECT M.MID FROM MOVIES M
						WHERE M.MLANGUAGE = 'TELUGU'
			         	   )
		    )

OUTPUT :-

AVG_AGE
24

7. QUERY :-

SELECT C.CID, AVG(M.MRATING) AS AVG_MRATING FROM CUSTOMER C
JOIN RESERVE R ON R.CID = C.CID
JOIN MOVIES M ON M.MID = R.MID
WHERE MLANGUAGE = 'ENGLISH'
GROUP BY C.CID

OUTPUT :-

CID	AVG_MRATING
101	9
102	7
105	9
110	7
111	8
112	8
116	9

8. QUERY :-

SELECT COUNT(MNAME) AS TOATAL_TM FROM MOVIES M
JOIN RESERVE R ON M.MID = R.MID
JOIN CUSTOMER C ON R.CID = C.CID
WHERE MLANGUAGE = 'TELUGU' AND MRATING BETWEEN 7 AND 9 AND C.AGE BETWEEN 20 AND 30

SELECT COUNT(MNAME) AS COUNT FROM MOVIES M
WHERE MLANGUAGE = 'TELUGU' AND MRATING BETWEEN 7 AND 9 AND M.MID IN (
												SELECT R.MID FROM RESERVE R
												WHERE R.CID IN (
															SELECT C.CID FROM CUSTOMER C
															WHERE C.AGE BETWEEN 20 AND 30
											        		   )
											   )

OUTPUT :-

TOATAL_TM
2

9. QUERY :-

SELECT CNAME FROM CUSTOMER
WHERE CID IN (
			SELECT CID FROM RESERVE
			WHERE RDATE = '2023-04-04'
		 )

OUTPUT :-

CNAME
SURYA
RAJINIKANTH

10. QUERY :-

SELECT COUNT(MNAME) AS COUNT_MOVIE FROM MOVIES 
WHERE MRATING < 8 AND MLANGUAGE <> 'ENGLISH'

OUTPUT :-

COUNT_MOVIE
5

11. QUERY :-

CREATE VIEW TELUGU
AS
(
	SELECT R.CID, R.RDATE, M.MID, M.MNAME, M.MLANGUAGE FROM RESERVE R
	JOIN MOVIES M ON R.MID = M.MID
	WHERE M.MLANGUAGE = 'TELUGU'
)

OUTPUT :-

CID	RDATE		MID	MNAME		MLANGUAGE
101	2023-04-04	501	DASARA	TELUGU
103	2023-04-02	525	SHIVAJI	TELUGU
104	2023-04-01	515	GINNA		TELUGU
101	2023-04-05	512	ORANGE	TELUGU
106	2023-03-05	504	BAHUBALI-2	TELUGU
107	2023-03-06	505	RRR		TELUGU
109	2023-04-05	507	PUSPHA	TELUGU
116	2023-04-04	501	DASARA	TELUGU




